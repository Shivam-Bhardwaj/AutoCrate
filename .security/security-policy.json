{
  "version": "1.0.0",
  "policies": {
    "dependencies": {
      "allowedLicenses": [
        "MIT",
        "Apache-2.0",
        "BSD-2-Clause",
        "BSD-3-Clause",
        "ISC",
        "0BSD",
        "CC-BY-4.0",
        "CC0-1.0"
      ],
      "deniedPackages": [],
      "vulnerabilityThreshold": "moderate",
      "autoUpdate": {
        "enabled": true,
        "frequency": "weekly",
        "types": ["patch", "minor"]
      }
    },
    "code": {
      "secrets": {
        "preventCommit": true,
        "patterns": [
          {
            "name": "AWS Access Key",
            "pattern": "AKIA[0-9A-Z]{16}"
          },
          {
            "name": "AWS Secret Key",
            "pattern": "aws[_\\-]?secret[_\\-]?access[_\\-]?key[\"']?\\s*[:=]\\s*[\"']?[A-Za-z0-9/+=]{40}[\"']?"
          },
          {
            "name": "API Key",
            "pattern": "(api[_\\-]?key|apikey)[\"']?\\s*[:=]\\s*[\"']?[A-Za-z0-9]{32,}[\"']?"
          },
          {
            "name": "Private Key",
            "pattern": "-----BEGIN (RSA|DSA|EC|OPENSSH) PRIVATE KEY-----"
          },
          {
            "name": "JWT Token",
            "pattern": "eyJ[A-Za-z0-9_-]{10,}\\.[A-Za-z0-9_-]{10,}\\.[A-Za-z0-9_-]{10,}"
          },
          {
            "name": "Database URL",
            "pattern": "(mongodb|postgres|mysql|redis)://[^\\s\"']+"
          }
        ]
      },
      "headers": {
        "required": [
          {
            "name": "X-Content-Type-Options",
            "value": "nosniff"
          },
          {
            "name": "X-Frame-Options",
            "value": "DENY"
          },
          {
            "name": "X-XSS-Protection",
            "value": "1; mode=block"
          },
          {
            "name": "Strict-Transport-Security",
            "value": "max-age=31536000; includeSubDomains"
          },
          {
            "name": "Content-Security-Policy",
            "value": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline';"
          }
        ]
      },
      "sanitization": {
        "enforceInputValidation": true,
        "preventSQLInjection": true,
        "preventXSS": true,
        "preventPathTraversal": true
      }
    },
    "authentication": {
      "passwordPolicy": {
        "minLength": 12,
        "requireUppercase": true,
        "requireLowercase": true,
        "requireNumbers": true,
        "requireSpecialChars": true,
        "preventCommonPasswords": true
      },
      "session": {
        "timeout": 3600,
        "renewBeforeExpiry": 300,
        "secureOnly": true,
        "httpOnly": true,
        "sameSite": "strict"
      },
      "mfa": {
        "required": false,
        "methods": ["totp", "sms", "email"]
      }
    },
    "dataProtection": {
      "encryption": {
        "atRest": true,
        "inTransit": true,
        "algorithm": "AES-256-GCM"
      },
      "pii": {
        "mask": true,
        "fields": ["email", "phone", "ssn", "creditCard"],
        "retention": 90
      },
      "backups": {
        "frequency": "daily",
        "encryption": true,
        "retention": 30
      }
    },
    "monitoring": {
      "logging": {
        "enabled": true,
        "level": "info",
        "sensitiveDataMasking": true,
        "retention": 90
      },
      "alerts": {
        "suspiciousActivity": true,
        "failedLogins": 5,
        "dataExfiltration": true
      }
    },
    "compliance": {
      "standards": ["OWASP", "GDPR", "SOC2"],
      "auditing": {
        "enabled": true,
        "frequency": "quarterly"
      }
    }
  },
  "scanners": {
    "npm": {
      "command": "npm audit",
      "threshold": "moderate"
    },
    "eslint": {
      "plugin": "eslint-plugin-security",
      "rules": {
        "detect-object-injection": "error",
        "detect-non-literal-regexp": "warn",
        "detect-unsafe-regex": "error",
        "detect-buffer-noassert": "error",
        "detect-child-process": "warn",
        "detect-disable-mustache-escape": "error",
        "detect-eval-with-expression": "error",
        "detect-no-csrf-before-method-override": "error",
        "detect-non-literal-fs-filename": "warn",
        "detect-non-literal-require": "warn",
        "detect-possible-timing-attacks": "warn",
        "detect-pseudoRandomBytes": "error"
      }
    },
    "semgrep": {
      "enabled": true,
      "rulesets": ["p/security-audit", "p/owasp-top-ten", "p/r2c-security-audit"]
    },
    "snyk": {
      "enabled": false,
      "token": "SNYK_TOKEN_PLACEHOLDER"
    }
  },
  "hooks": {
    "preCommit": [
      "npm run lint",
      "npm audit --audit-level=moderate",
      "node scripts/consistency-checkers/security-scanner.js"
    ],
    "prePush": ["npm test", "npm run build"]
  },
  "reporting": {
    "format": "json",
    "output": ".security/reports",
    "includeFixed": false,
    "includeLowSeverity": false
  }
}
